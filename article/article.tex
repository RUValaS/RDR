\documentclass[titlepage]{article}
\usepackage[upright]{fourier}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage[margin=1in]{geometry}
\usepackage[T1]{fontenc}

\usepackage[colorlinks=true,linkcolor=teal]{hyperref}
\usepackage{amssymb,amsmath,minted,float,graphicx,textcomp,systeme,listings,physics,mathtools,ifthen,esvect,hyperref,fancyhdr,lastpage,marginnote,chngcntr,fancyvrb,subcaption,svg}

\usepackage[backend=biber,style=numeric]{biblatex}
\addbibresource{article.bib}

\DeclareMathOperator{\e}{e}
\def\mathbi#1{\textbf{\em #1}}

\setlength\parindent{0pt}

%%%%%%%%%%%% PARAMETRES
\newcommand{\UE}{4XX}
\newcommand{\type}{}%TD-TP-COURS
\newcommand{\nb}{0}%nb 
\newcommand{\sbt}{}%soustitre
\author{Gabriel ROBERT-DAUTUN}
\date{Mars 2022}

% mise en page (header, compteur, fancy)
\pagestyle{fancy}
\lhead{Dynamic image reconstruction}
\rfoot{\thepage /\pageref{LastPage}}
\lfoot{}
\cfoot{}
\renewcommand{\footrulewidth}{0.4pt}

%reset compteur section par partie
\counterwithin*{section}{part}

% permet notes + simples en marge à gauche (eg compteur de question)
\reversemarginpar
\newcommand{\mgn}[1]{\marginnote{#1}}

%sinon warning mdr
\setlength{\headheight}{13.07225pt}

\newcommand{\hinv}[1]{#1^{\circ-1}} % inverse de hadamard
\newcommand{\fnorm}[1]{|\vert#1|\vert_{F}} % norme de Frobenius
\newcommand{\moy}[1]{\boldsymbol{\mathsf{m}}_{#1}}

\renewcommand{\expval}[1]{\text{E}\left[#1\right]}
\newcommand{\w}{\boldsymbol{w}}
\renewcommand{\v}{\boldsymbol{v}}
\newcommand{\Q}{\boldsymbol{\mathsf{Q}}}
\newcommand{\R}{\boldsymbol{\mathsf{R}}}

\newcommand{\x}{\boldsymbol{x}}
\newcommand{\y}{\boldsymbol{y}}

\newcommand{\xp}{\widehat{\x}_{k|k-1}}
\newcommand{\xa}{\widehat{\x}_{k-1|k-1}}
\newcommand{\xe}{\widehat{\x}_{k|k}}
\newcommand{\yp}{\widehat{\y}_{k|k-1}}

\newcommand{\Pp}{\boldsymbol{\mathsf{P}}_{k|k-1}}
\newcommand{\Pa}{\boldsymbol{\mathsf{P}}_{k-1|k-1}}
\newcommand{\Pe}{\boldsymbol{\mathsf{P}}_{k|k}}

\title{%
	Radioastronomical image reconstruction using Kalman filter under ionospheric perturbations}

\begin{document}
	
	\begin{titlepage}
	
	\vspace*{.3\textheight}
	\huge
	\centering
	\textbf{Dynamic radioastronomic image reconstruction using Kalman filter under ionospheric perturbations}
	
	\vspace{1cm}
	\LARGE
	G. Robert-Dautun
	
	\vfill
	\large
	Supervised by I. Vin
	
	\vspace{0.8cm}
	
	\Large
	Satie\\
	France\\
	July 2022
	
	\end{titlepage}
	
	\newpage
	\tableofcontents
	
	\newpage
	
	\part{Introduction}
	
		A Kalman filter is a linear quadratic estimator, using observations, state-transition model and knowledge about noise and errors to compute a more accurate result than observations alone. Radio astronomical measures being prone to noise and errors, usage of this filtering method seems \emph{a priori} a good way to improve accuracy of reconstruction. \\
		One objective of this paper is to evaluate if measure conditions and results are compatible with the filtering.
	
	
	
	\newpage
	\part{Notations and problem}
	\section{Notations}
	
	\subsection{General notations}
	
	$\expval{\bullet}$ denotes the expected value of a random variable/vector/matrix.
	
	\paragraph{}Bold symbols represent vectors, normal ones represent scalars
	
	
	
		\subsection{Hadamard product}
	
	%On introduit la notation $\odot$ associée au produit de Hadamard, qui effectue la multiplication élément à élément de deux matrices de même taille :
	Hadamard product, denoted $\odot$, is the element-wise product of same sized matrices :
	
	$$
	\forall (A,B)\in\left(\mathbb{C}^{m\times n}\right)^2, \quad A\odot B\in\mathbb{C}^{m\times n} \quad\text{and}\quad \forall (i,j)\in\llbracket1;m\rrbracket\times\llbracket1;n\rrbracket,\, (A\odot B)_{i,j} = A_{i,j}\times B_{i,j}
	$$
	
	%On introduit également l'inverse de Hadamard, qui inverse élément par élément une matrice
	We can further introduce Hadamard inversion :
	$$
	\forall A \in \left(\mathbb{C}\backslash\{0\}\right)^{m\times n},\quad \hinv{A}\in\left(\mathbb{C}\backslash\{0\}\right)^{m\times n} \quad\text{and}\quad \forall (i,j)\in\llbracket1;m\rrbracket\times\llbracket1;n\rrbracket,\, \left(\hinv{A}\right)_{i,j} = \left(A_{i,j}\right)^{-1}
	$$ 
	
%	Ainsi que la notation $\oslash$ désignant la division de Hadamard :
	And notation $\oslash$ being Hadamard division :
	$$
	\forall (A,B)\in\mathbb{C}^{m\times n}\times\left(\mathbb{C}\backslash0\right)^{m\times n}, \quad A\oslash B\in\mathbb{C}^{m\times n} \quad\text{and}\quad \forall (i,j)\in\llbracket1;m\rrbracket\times\llbracket1;n\rrbracket,\, (A\oslash B)_{i,j} = \frac{A_{i,j}}{B_{i,j}}
	$$
	
	\subsection{Norms and distances}
	
	%On dénote $\fnorm{\bullet}$ la norme de Frobenius :
	In order to compute distances between matrices, we note $\fnorm{\bullet}$ Frobenius norm :
	$$
	A\in\mathcal{M}_{m,n}(\mathbb{K}) \quad \fnorm{A} := \sqrt{\tr{AA^H}} = \sqrt{
		\;\;\;\sum_{
			\mathclap{
				\substack{
					1\le i\le m \\1\le j\le n
				}
			}
		}\abs{A_{ij}}^2}
	$$
	
	%Qui induit sur $\mathcal{M}_{m,n}(\mathbb{D})$ la distance normalisée $d_1$ :
	Inducing the distance $d_1$ :
	$$
	\forall(A,B)\in\left(\mathcal{M}_{m,n}(\mathbb{K})\right)^2\quad d_1(A,B) = \frac{\fnorm{A-B}}{mn}
	$$
	
	%Ainsi que la distance $d_2$ :
	In order to measure influence of a specific element, the ??? distance $d_2$ is the following :
	$$
	\forall(A,B)\in\left(\mathcal{M}_{m,n}(\mathbb{K})\right)^2\quad d_2(A,B) = \sum_{
		\mathclap{
			\substack{
				1\le i\le m \\1\le j\le n
			}
		}
	}\abs{A_{ij} - B_{i,j}}
	$$
	
	
	\section{Evolution model and Kalman filtering}
	
	We consider a set $\{x_k\}$ of $n$ vector as theoretical images taken at a regular time interval. Those images are measured by an antenna mesh which UV plane will be written $H$, more generally written as observation model. Measurements vectors will be designated by $n$ measures $\{y_k\}$.\\
	We will consider the following model to describe time evolution and observation equation :
	$$
		\begin{cases}
			\x_k = A\x_{k-1} + \w_{k-1}\\
			\y_k = H\x_k + \v_k
		\end{cases}
	$$
	
	Where :
	\begin{itemize}
		\item $A$ is the linear state-transition model between time $k-1$ and $k$, assuming evolution is time invariant
		\item $\{\w_k\}$ is the state noise sequence
		\item $\{\v_k\}$ is the measurements noise sequence
	\end{itemize}
	
		
	In order to build images dynamically with better precision, a Kalman filter has been implemented.\\
	
	This filter requires more inputs to estimate the state of the system :
	\begin{itemize}
		\item $\{\Q_k\}$, the covariance of the process noise sequence
		\item $\{\R_k\}$, the covariance of the observation noise sequence
	\end{itemize}

	Which can be rewritten as
	$$
		\begin{cases}
			\Q_k = \expval{\w_{k-1}\w_{k-1}^H} - \expval{\w_{k-1}}\expval{\w_{k-1}}^H \\
			\R_k = \expval{\v_{k}\v_{k}^H} - \expval{\v_k}\expval{\v_k}^H 
		\end{cases}
	$$
	
	Those inputs are not \emph{a priori} known, but it has been shown that using the \emph{autocovariance least-squares} (ALS) method provides a good estimate of those matrices. [CITATION NEEDED] \\
	We will assume that these inputs are known perfectly except when specified otherwise.\\
	
	Kalman filtering works in 2 steps :
	\paragraph{Prediction} : This step predicts the state of the system at next time-step through de transition-state model, and the predicted measurement :
	$$
	\begin{cases}
		\xp = A\xa + \moy{\w_k}\\
		\yp = H\xp + \moy{\v_k}
	\end{cases}
	$$
	And the covariance matrix :
	$$
		\Pp = H\Pa H^H + \Q_k
	$$
	This result can be computed using least-square estimation of the prediction error covariance\cite{intro_KF}
	
	\paragraph{Update} : Using prior knowledge about noise and observation model, the main goal is to build an image from both prediction and measurement using maximum likelihood estimation to mix them. 
	
	
	\newpage
	\part{Reliability of Kalman Filter under perturbations}
	\section{Perturbations sources}
	\section{Effects}
	\subsection{Position}
	\subsection{Direction}
	
	\newpage
	\part{Experimental correction}
	\section{implementation}
	\section{Measures}
	
	
	\newpage
	\printbibliography
\end{document}

\begin{figure}[H]
	\centering
	\includegraphics[width=0.7\linewidth]{}
	\caption{}
\end{figure}

\begin{figure}[H]
	\centering
	\begin{subfigure}{.5\textwidth}
		\centering
		\includegraphics[width=.4\linewidth]{image1}
		\caption{}
	\end{subfigure}%
	\begin{subfigure}{.5\textwidth}
		\centering
		\includegraphics[width=.4\linewidth]{image2}
		\caption{}
	\end{subfigure}
	\caption{}
\end{figure}
